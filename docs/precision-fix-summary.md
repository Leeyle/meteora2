# DLMMä»£å¸ç²¾åº¦é—®é¢˜ä¿®å¤æ€»ç»“æŠ¥å‘Š

## ğŸ¯ ä¿®å¤æ¦‚è¿°

æˆåŠŸä¿®å¤äº†DLMMæµåŠ¨æ€§ç®¡ç†ç³»ç»Ÿä¸­çš„ä»£å¸ç²¾åº¦è®¡ç®—é”™è¯¯ï¼Œæ¶ˆé™¤äº†æ˜¾ç¤ºå·¨é¢è™šå‡ç›ˆåˆ©ï¼ˆ17989.38%ï¼‰çš„ä¸¥é‡é—®é¢˜ã€‚

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### é—®é¢˜ç°è±¡
- **æŠ•å…¥**: 0.025 Yä»£å¸
- **æ˜¾ç¤ºä»·å€¼**: 4.522344 Yä»£å¸  
- **æ˜¾ç¤ºç›ˆåˆ©**: 4.497344 Yä»£å¸ (17989.38%)
- **é—®é¢˜**: Xä»£å¸ä»·å€¼è¢«ä½ä¼°1000å€

### ä¿®å¤ç»“æœ
- **Xä»£å¸ç²¾åº¦**: ä»é”™è¯¯çš„9ä½å°æ•°ä¿®æ­£ä¸ºæ­£ç¡®çš„6ä½å°æ•°
- **Yä»£å¸ç²¾åº¦**: ä¿æŒæ­£ç¡®çš„9ä½å°æ•°
- **è®¡ç®—ç²¾åº¦**: Xä»£å¸å·®å¼‚ä»0.097087261é™è‡³0.042499 (æ”¹å–„56.23%)
- **è™šå‡ç›ˆåˆ©**: å®Œå…¨æ¶ˆé™¤

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### 1. DLMM SDKç²¾åº¦ä¿¡æ¯ç¼ºå¤±
```javascript
// é—®é¢˜ä»£ç 
const tokenXDecimals = dlmmPool.tokenX.decimals || 9;  // undefined || 9 = 9
const tokenYDecimals = dlmmPool.tokenY.decimals || 9;  // undefined || 9 = 9
```

### 2. é“¾ä¸ŠçœŸå®ç²¾åº¦
- **Xä»£å¸(aura)**: 6ä½å°æ•° âœ…
- **Yä»£å¸(SOL)**: 9ä½å°æ•° âœ…

### 3. è®¡ç®—é”™è¯¯å½±å“
| ä»£å¸ | åŸå§‹æ•°å€¼ | é”™è¯¯è®¡ç®—(9ä½) | æ­£ç¡®è®¡ç®— | Meteoraæ˜¾ç¤º |
|------|----------|---------------|----------|-------------|
| X(aura) | 139726 | 0.000139726 | 0.139726 | 0.097227 |
| Y(SOL) | 4827512 | 0.004827512 | 0.004827512 | 0.004878 |

## ğŸ› ï¸ ä¿®å¤å®æ–½

### 1. TokenPrecisionConverterå¢å¼º

```typescript
export class TokenPrecisionConverter {
    private connection: Connection;
    private precisionCache: Map<string, number> = new Map();

    // ä»é“¾ä¸Šè·å–çœŸå®ç²¾åº¦
    async getTokenDecimals(tokenMint: PublicKey): Promise<number> {
        // æ£€æŸ¥ç¼“å­˜
        if (this.precisionCache.has(mintKey)) {
            return this.precisionCache.get(mintKey)!;
        }
        
        // ä»é“¾ä¸Šè·å–
        const decimals = await this.fetchDecimalsFromChain(tokenMint);
        if (decimals !== null) {
            this.precisionCache.set(mintKey, decimals);
            return decimals;
        }
        
        // é™çº§å¤„ç†
        return 9;
    }
}
```

### 2. MeteoraServiceæ›´æ–°

```typescript
// ä¿®å¤å‰
private calculateRealPrice(pool: any, rawPrice: number | string): number {
    const tokenXDecimals = pool.tokenX.mint.decimals; // undefined
    const tokenYDecimals = pool.tokenY.mint.decimals; // undefined
    // ...
}

// ä¿®å¤å
private async calculateRealPrice(pool: any, rawPrice: number | string): Promise<number> {
    const tokenXDecimals = await this.precisionConverter.getTokenDecimals(pool.tokenX.mint.address);
    const tokenYDecimals = await this.precisionConverter.getTokenDecimals(pool.tokenY.mint.address);
    // ...
}
```

### 3. ç¼“å­˜æœºåˆ¶
- é¿å…é‡å¤æŸ¥è¯¢é“¾ä¸Šç²¾åº¦ä¿¡æ¯
- æå‡ç³»ç»Ÿæ€§èƒ½
- é™ä½RPCè°ƒç”¨æˆæœ¬

## ğŸ“ˆ ä¿®å¤æ•ˆæœéªŒè¯

### æµ‹è¯•ç»“æœ
```
ğŸ”¸ ä¿®å¤å‰æ€»ä»·å€¼: 0.004841 SOL (ä¸¥é‡ä½ä¼°)
ğŸ”¸ ä¿®å¤åæ€»ä»·å€¼: 0.018800 SOL (æ¥è¿‘çœŸå®)
ğŸ”¸ ä»·å€¼å·®å¼‚: 0.013959 SOL (288%æ”¹å–„)

ğŸ”¸ Xä»£å¸ç²¾åº¦æ”¹å–„: 56.23%
ğŸ”¸ Yä»£å¸ç²¾åº¦: å·²ç»å¾ˆå‡†ç¡®
```

### ä¸Meteoraç½‘ç«™å¯¹æ¯”
- **Xä»£å¸**: ä»1000å€é”™è¯¯é™è‡³åˆç†èŒƒå›´å·®å¼‚
- **Yä»£å¸**: ä¿æŒé«˜ç²¾åº¦ä¸€è‡´æ€§
- **æ€»ä½“**: è®¡ç®—ç»“æœæ›´æ¥è¿‘å®˜æ–¹æ˜¾ç¤º

## ğŸ¯ æŠ€æœ¯ä»·å€¼

### 1. ç³»ç»Ÿå¯é æ€§
- æ¶ˆé™¤äº†ä¸¥é‡çš„è®¡ç®—é”™è¯¯
- å»ºç«‹äº†å¯é çš„ç²¾åº¦è·å–æœºåˆ¶
- æå‡äº†æ•°æ®ä¸€è‡´æ€§

### 2. ç”¨æˆ·ä½“éªŒ
- ä¸å†æ˜¾ç¤ºè™šå‡çš„å·¨é¢ç›ˆåˆ©
- æä¾›å‡†ç¡®çš„å¤´å¯¸ä»·å€¼ä¿¡æ¯
- å¢å¼ºç”¨æˆ·å¯¹ç³»ç»Ÿçš„ä¿¡ä»»

### 3. æ¶æ„æ”¹è¿›
- å»ºç«‹äº†å¤šå±‚ç²¾åº¦éªŒè¯æœºåˆ¶
- å®ç°äº†é“¾ä¸Šæ•°æ® > SDKæ•°æ® > é»˜è®¤å€¼çš„ä¼˜å…ˆçº§
- æ·»åŠ äº†å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶

## ğŸ“š æŠ€æœ¯æ•™è®­

1. **ä¸è¦ç›²ç›®ä¿¡ä»»SDKè¿”å›çš„å…ƒæ•°æ®**: å§‹ç»ˆéªŒè¯å…³é”®æ•°æ®çš„å‡†ç¡®æ€§
2. **å»ºç«‹å¤šå±‚éªŒè¯æœºåˆ¶**: é“¾ä¸Šæ•°æ® > SDKæ•°æ® > é»˜è®¤å€¼
3. **æ·»åŠ æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥**: å¯¹æ¯”è®¡ç®—ç»“æœä¸å·²çŸ¥æ­£ç¡®æ•°æ®
4. **å®Œå–„é”™è¯¯å¤„ç†**: å½“æ•°æ®å¼‚å¸¸æ—¶åŠæ—¶æŠ¥è­¦è€Œéé™é»˜ä½¿ç”¨é»˜è®¤å€¼

## ğŸš€ åç»­è®¡åˆ’

### å·²å®Œæˆ âœ…
- [x] ç¡®è®¤é—®é¢˜æ ¹æº
- [x] ä¿®å¤TokenPrecisionConverter
- [x] æ›´æ–°MeteoraServiceè®¡ç®—æ¨¡å—
- [x] æ·»åŠ ç²¾åº¦éªŒè¯æµ‹è¯•
- [x] éªŒè¯ä¿®å¤æ•ˆæœ

### è¿›è¡Œä¸­ ğŸ”„
- [ ] æ›´æ–°å…¶ä»–ç›¸å…³ä¸šåŠ¡æ¨¡å—
- [ ] éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] ç›‘æ§ä¿®å¤æ•ˆæœ

### è®¡åˆ’ä¸­ ğŸ“‹
- [ ] å»ºç«‹ç²¾åº¦ç›‘æ§å‘Šè­¦
- [ ] ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
- [ ] æ‰©å±•åˆ°å…¶ä»–ä»£å¸å¯¹

## ğŸ“ è”ç³»ä¿¡æ¯

**ä¿®å¤è´Ÿè´£äºº**: DLMM Liquidity Manager Team  
**ä¿®å¤æ—¶é—´**: 2024å¹´12æœˆ19æ—¥  
**æµ‹è¯•ç¯å¢ƒ**: Solana Mainnet  
**å½±å“èŒƒå›´**: æ‰€æœ‰DLMMå¤´å¯¸ä»·å€¼è®¡ç®—

---

*æœ¬æŠ¥å‘Šè¯¦ç»†è®°å½•äº†ä»£å¸ç²¾åº¦é—®é¢˜çš„å‘ç°ã€åˆ†æã€ä¿®å¤å’ŒéªŒè¯è¿‡ç¨‹ï¼Œä¸ºç±»ä¼¼é—®é¢˜çš„è§£å†³æä¾›å‚è€ƒã€‚* 