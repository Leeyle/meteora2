收益提取系统详细说明
1. 时间锁机制 🔒
冷却时间: 3分钟（180秒）
触发条件: 收益提取成功或失败后立即激活
影响范围: 仅限收益提取操作，不影响其他功能
状态查询: 提供剩余冷却时间和锁定状态
重置功能: 提供调试用的时间锁重置方法
2. 状态管理机制 📊
状态类型: IDLE（空闲）、EXTRACTING（提取中）
状态回调: 通过回调机制通知 PositionAnalyticsService
并发控制: 防止同时进行多个收益提取操作
异常处理: 异常情况下自动重置状态
3. 收益检查条件 ✅
阈值比较: currentPendingYield >= threshold
时间锁检查: 确保距离上次提取超过3分钟
状态检查: 确保当前不在提取状态
数据有效性: 检查收益数据的有效性
4. 分池批量提取 🏊
池子分组: 按池子地址分组头寸，避免重复提取
逐池处理: 每个池子独立进行批量提取
失败隔离: 单个池子失败不影响其他池子
统计汇总: 汇总所有池子的提取结果
5. 交易验证机制 🔍
4次验证: 3s、6s、9s、12s间隔进行4次确认
状态检查: 验证交易状态（成功/失败/待处理）
插槽确认: 记录交易确认的区块插槽
重试逻辑: 验证失败时的重试机制
6. 代币交换处理 🔄
X代币处理: 自动将X代币交换为Y代币
余额查询: 动态查询实际代币余额
精度处理: 动态获取代币精度信息
独立操作: 交换失败不影响收益记录
7. 数据记录与统计 📈
收益记录: 记录到 AccumulatedYieldManager
操作统计: 提取次数、总金额、错误次数
实例感知: 支持策略实例级别的日志记录
业务日志: 记录到业务操作日志
8. 错误处理与恢复 ⚠️
异常捕获: 完整的错误捕获和处理
状态恢复: 异常情况下的状态重置
日志记录: 详细的错误日志记录
优雅降级: 部分失败不影响整体流程
9. 性能监控 📊
操作统计: 实时统计提取操作数据
时间锁状态: 提供时间锁状态查询
缓存管理: 避免重复的RPC调用
资源优化: 合理的资源使用和释放
10. 配置与限制 ⚙️
滑点设置: 代币交换默认8%滑点
重试次数: 各种操作的重试限制
超时设置: 操作超时时间控制
日志级别: 不同级别的日志输出
这个收益提取系统是一个完整的、容错的、高性能的解决方案，通过多层防护确保操作的可靠性和安全性。