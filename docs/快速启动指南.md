 # DLMM流动性管理器 - 快速启动指南

## 🚀 快速开始

### 1️⃣ 环境准备

确保您的系统满足以下要求：

```bash
# 检查Node.js版本（需要 >= 18.0.0）
node --version

# 检查npm或pnpm
npm --version
# 或
pnpm --version
```

### 2️⃣ 项目安装

```bash
# 1. 进入项目目录
cd dlmm-liquidity-manager

# 2. 安装依赖
npm install
# 或使用pnpm（推荐）
pnpm install

# 3. 安装Web前端依赖
cd web && npm install && cd ..

# 4. 验证TypeScript编译
npx tsc --noEmit
```

### 🌐 端口配置

| 服务 | 端口 | 描述 | 访问地址 |
|------|------|------|----------|
| 后端API | 7000 | 主要API服务 | http://localhost:7000 |
| 前端Web | 7001 | Web界面仪表盘 | http://localhost:7001 |
| WebSocket (后端) | 7002 | 后端实时通信 | ws://localhost:7002 |
| WebSocket (前端) | 7003 | 前端实时通信 | ws://localhost:7003 |

### 3️⃣ 环境配置

```bash
# 1. 复制环境配置文件
cp env.example .env

# 2. 编辑配置文件（可选，开发环境可跳过）
# vim .env
```

### 4️⃣ 编译和构建

```bash
# 方式1: 只检查语法（快速）
npx tsc --noEmit

# 方式2: 完整构建（如果有构建脚本）
npm run build

# 方式3: 开发模式（推荐）
npm run dev
```

### 5️⃣ 运行测试

```bash
# 🧪 运行系统功能测试
./scripts/test-system.sh

# 🚀 一键启动系统（包含测试）
./scripts/quick-start.sh

# 🛑 一键关闭所有服务
./scripts/quick-stop.sh
```

### 6️⃣ 启动服务

```bash
# 🚀 一键启动脚本（推荐）
./scripts/quick-start.sh

# 方式1: 启动后端API (端口7000)
npm run dev

# 方式2: 启动前端界面 (端口7001)
npm run dev:web

# 方式3: 生产模式
npm start

# 方式4: 直接运行API服务器
cd src/server && node api-server.js
```

## 🧪 验证安装

### 编译检查
```bash
# 检查TypeScript编译
npx tsc --noEmit

# 如果成功，不会有任何输出
echo "✅ TypeScript编译检查通过"
```

### 模块验证
```bash
# 检查源码结构
ls -la src/
ls -la src/services/strategy/
ls -la src/types/

# 验证核心文件存在
[ -f src/services/strategy/StrategyEngine.ts ] && echo "✅ StrategyEngine.ts存在"
[ -f src/services/strategy/StrategyCore.ts ] && echo "✅ StrategyCore.ts存在"
[ -f src/types/strategy.ts ] && echo "✅ strategy.ts存在"
```

### API测试（如果服务器运行中）
```bash
# 后端API健康检查
curl http://localhost:7000/api/health

# 前端Web界面健康检查
curl http://localhost:7001/health

# 策略API
curl http://localhost:7000/api/strategy/list

# 监控面板
curl http://localhost:7000/api/monitor/dashboard
```

## 🛠️ 故障排除

### 编译错误
如果遇到TypeScript编译错误：

```bash
# 1. 清理缓存
rm -rf node_modules/.cache
rm -rf dist/

# 2. 重新安装依赖
rm -rf node_modules/
npm install

# 3. 再次检查编译
npx tsc --noEmit
```

### 依赖问题
如果遇到依赖问题：

```bash
# 检查package.json
cat package.json | grep -A 10 '"dependencies"'

# 安装特定依赖
npm install inversify reflect-metadata

# 检查版本兼容性
npm ls
```

### 权限问题
如果脚本没有执行权限：

```bash
# 添加执行权限
chmod +x scripts/quick-start.sh
chmod +x scripts/test-system.sh

# 验证权限
ls -la scripts/
```

## 📊 系统状态检查

### 当前重构状态

✅ **已完成的模块**：
- 策略引擎核心架构 (StrategyEngine, StrategyCore, StrategyScheduler)
- 策略管理组件 (InstanceManager, Monitor, RecoveryManager, StateManager)
- 类型系统重构 (strategy.ts, interfaces.ts)
- 模块化架构设计
- TypeScript编译错误修复

⚠️ **需要注意的事项**：
- 某些业务服务模块可能需要进一步实现
- 区块链服务集成需要实际的RPC配置
- 数据库连接需要配置实际的连接字符串

### 架构优势

1. **模块化设计** - 每个模块职责单一，易于维护
2. **类型安全** - 完整的TypeScript类型系统
3. **事件驱动** - 异步事件处理，性能优化
4. **故障恢复** - 自动故障检测和恢复机制
5. **监控系统** - 实时性能监控和预警

## 🎯 下一步

### 开发建议
1. **快速启动**: 使用 `./scripts/quick-start.sh` 一键启动系统
2. **后端开发**: 使用 `npm run dev` 启动后端API (端口7000)
3. **前端开发**: 使用 `npm run dev:web` 启动前端界面 (端口7001)
4. **功能测试**: 运行 `./scripts/test-system.sh` 验证系统
5. **API调试**: 使用Postman或curl测试API接口
6. **监控查看**: 访问 `http://localhost:7001` 查看Web仪表盘

### 部署建议
1. **环境配置**: 配置生产环境的 `.env` 文件
2. **构建优化**: 使用 `npm run build:prod` 构建生产版本
3. **容器化**: 使用 `docker-compose up -d` 部署
4. **监控配置**: 配置Prometheus和Grafana监控

---

🎉 **现在您已经掌握了DLMM流动性管理器的快速启动方法！**

如果遇到问题，请查看：
- 📖 [完整文档](./README-系统架构与使用指南.md)
- 🏗️ [架构图](./系统架构图.md)
- 🧪 [测试脚本](../scripts/test-system.sh)