# DLMMæµåŠ¨æ€§ç®¡ç†å™¨ - ç³»ç»Ÿæ¶æ„ä¸ä½¿ç”¨æŒ‡å—

## ğŸ“š é¡¹ç›®æ¦‚è¿°

DLMMæµåŠ¨æ€§ç®¡ç†å™¨æ˜¯ä¸€ä¸ªåŸºäºSolanaåŒºå—é“¾çš„Meteora DLMMï¼ˆåŠ¨æ€æµåŠ¨æ€§å¸‚åœºåˆ¶é€ å•†ï¼‰è‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿã€‚ç»è¿‡é‡æ„ä¼˜åŒ–ï¼Œç°åœ¨é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œæ”¯æŒå¤šç§ç­–ç•¥ç±»å‹çš„å¹¶å‘æ‰§è¡Œå’Œæ™ºèƒ½è°ƒåº¦ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ¥å£å±‚ (UI Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ä¸šåŠ¡é€»è¾‘å±‚ (Business Layer)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   æœåŠ¡å±‚ (Service Layer)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—åŒ–ç»„ä»¶æ¶æ„

#### ğŸ¯ ç­–ç•¥å¼•æ“æ¨¡å— (Strategy Engine)
- **StrategyEngine** - ä¸»å¼•æ“ï¼Œè´Ÿè´£ç­–ç•¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **StrategyCore** - ç­–ç•¥æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **StrategyScheduler** - ä»»åŠ¡è°ƒåº¦å™¨ï¼Œæ”¯æŒä¼˜å…ˆçº§å’Œå¹¶å‘æ§åˆ¶
- **StrategyInstanceManager** - å®ä¾‹ç®¡ç†å™¨ï¼Œæä¾›æ‰¹é‡æ“ä½œ
- **StrategyMonitor** - å®æ—¶ç›‘æ§å’Œæ€§èƒ½åˆ†æ
- **StrategyRecoveryManager** - æ•…éšœæ¢å¤å’Œå¥åº·æ£€æŸ¥
- **StrategyStateManager** - çŠ¶æ€ç®¡ç†å’Œå¿«ç…§æ¢å¤

#### ğŸ”— åŒºå—é“¾æœåŠ¡æ¨¡å—
- **SolanaService** - SolanaåŒºå—é“¾äº¤äº’
- **MeteoraService** - Meteora DLMMåè®®é›†æˆ
- **TransactionService** - äº¤æ˜“ç®¡ç†å’Œç¡®è®¤

#### ğŸ¢ ä¸šåŠ¡æœåŠ¡æ¨¡å—  
- **PositionManager** - å¤´å¯¸ç®¡ç†
- **YPositionManager** - Yè½´å¤´å¯¸ä¸“ç”¨ç®¡ç†
- **XPositionManager** - Xè½´å¤´å¯¸ä¸“ç”¨ç®¡ç†
- **PositionFeeHarvester** - æ‰‹ç»­è´¹æ”¶å‰²
- **PositionInfoService** - å¤´å¯¸ä¿¡æ¯æŸ¥è¯¢

#### ğŸ› ï¸ åŸºç¡€è®¾æ–½æ¨¡å—
- **ConfigService** - é…ç½®ç®¡ç†
- **LoggerService** - æ—¥å¿—æœåŠ¡
- **StateService** - çŠ¶æ€æŒä¹…åŒ–
- **EventBus** - äº‹ä»¶æ€»çº¿
- **ä¾èµ–æ³¨å…¥å®¹å™¨** - IoCç®¡ç†

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### ç­–ç•¥ç±»å‹æ”¯æŒ
- **SIMPLE_Y** - ç®€å•Yè½´ç­–ç•¥
- **DUAL_POSITION** - åŒå¤´å¯¸ç­–ç•¥  
- **PRICE_TRIGGER** - ä»·æ ¼è§¦å‘ç­–ç•¥
- **FORCE_STOP** - å¼ºåˆ¶åœæ­¢ç­–ç•¥

### é«˜çº§åŠŸèƒ½
- âœ… **å¹¶å‘æ‰§è¡Œ** - æ”¯æŒæœ€å¤š10ä¸ªç­–ç•¥å¹¶å‘è¿è¡Œ
- âœ… **æ™ºèƒ½è°ƒåº¦** - åŸºäºä¼˜å…ˆçº§å’Œèµ„æºçš„ä»»åŠ¡è°ƒåº¦
- âœ… **å®æ—¶ç›‘æ§** - æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œé¢„è­¦ç³»ç»Ÿ
- âœ… **æ•…éšœæ¢å¤** - è‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œæ¢å¤æœºåˆ¶
- âœ… **çŠ¶æ€ç®¡ç†** - å¿«ç…§åˆ›å»ºå’ŒçŠ¶æ€æ¢å¤
- âœ… **æ‰¹é‡æ“ä½œ** - å®ä¾‹çš„æ‰¹é‡ç®¡ç†å’Œæ“ä½œ
- âœ… **æ¨¡æ¿ç³»ç»Ÿ** - ç­–ç•¥æ¨¡æ¿åˆ›å»ºå’Œå¤ç”¨

### æ€§èƒ½ä¼˜åŒ–
- **äº‹ä»¶é©±åŠ¨æ¶æ„** - å¼‚æ­¥äº‹ä»¶å¤„ç†
- **å†…å­˜ä¼˜åŒ–** - æ™ºèƒ½ç¼“å­˜å’Œæ•°æ®æ¸…ç†
- **å¹¶å‘æ§åˆ¶** - çº¿ç¨‹å®‰å…¨çš„èµ„æºè®¿é—®
- **ç›‘æ§è½®è¯¢** - é«˜æ•ˆçš„æ€§èƒ½æ•°æ®æ”¶é›†

## ğŸ“¦ å®‰è£…ä¸é…ç½®

### ç¯å¢ƒè¦æ±‚
- **Node.js** >= 18.0.0
- **TypeScript** >= 5.0.0
- **pnpm** æˆ– **npm**

### å®‰è£…ä¾èµ–
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd dlmm-liquidity-manager

# å®‰è£…ä¾èµ–
npm install
# æˆ–
pnpm install
```

### ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ¨¡æ¿
cp env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼š
```env
# Solanaé…ç½®
SOLANA_RPC_URL=https://api.mainnet-beta.solana.com
WALLET_PRIVATE_KEY=your_wallet_private_key

# Meteoraé…ç½®  
METEORA_API_URL=https://meteora.ag/api

# æ•°æ®åº“é…ç½®
DB_CONNECTION_STRING=your_database_url

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_FILE_PATH=./logs
```

## ğŸ® å¯åŠ¨ä¸è¿è¡Œ

### å¼€å‘æ¨¡å¼å¯åŠ¨

```bash
# ç¼–è¯‘TypeScript
npm run build

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æˆ–è€…ç›´æ¥è¿è¡Œ
npm start
```

### ç”Ÿäº§æ¨¡å¼å¯åŠ¨

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build:prod

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run start:prod
```

### Dockeréƒ¨ç½²

```bash
# æ„å»ºDockeré•œåƒ
docker build -t dlmm-manager .

# è¿è¡Œå®¹å™¨
docker run -d -p 3000:3000 \
  --env-file .env \
  --name dlmm-manager \
  dlmm-manager

# æˆ–ä½¿ç”¨docker-compose
docker-compose up -d
```

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œç­–ç•¥å¼•æ“æµ‹è¯•
npm run test:strategy

# è¿è¡ŒæœåŠ¡å±‚æµ‹è¯•
npm run test:services

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### é›†æˆæµ‹è¯•

```bash
# å¯åŠ¨æµ‹è¯•ç¯å¢ƒ
npm run test:integration

# æµ‹è¯•åŒºå—é“¾è¿æ¥
npm run test:blockchain

# æµ‹è¯•Meteoraé›†æˆ
npm run test:meteora
```

### APIæµ‹è¯•

```bash
# å¯åŠ¨APIæœåŠ¡å™¨
npm run start:api

# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:3000/health

# æµ‹è¯•ç­–ç•¥æ¥å£
curl -X POST http://localhost:3000/api/strategies \
  -H "Content-Type: application/json" \
  -d '{"type": "SIMPLE_Y", "poolAddress": "...", "yAmount": 1000}'
```

## ğŸ“Š ç›‘æ§ä¸ç®¡ç†

### Webæ§åˆ¶å°
è®¿é—® `http://localhost:3000/dashboard` æŸ¥çœ‹ï¼š
- ç­–ç•¥è¿è¡ŒçŠ¶æ€
- æ€§èƒ½ç›‘æ§å›¾è¡¨
- å®æ—¶æ—¥å¿—è¾“å‡º
- ç³»ç»Ÿå¥åº·çŠ¶æ€

### APIæ¥å£

#### ç­–ç•¥ç®¡ç†
```bash
# åˆ›å»ºç­–ç•¥
POST /api/strategies
{
  "type": "SIMPLE_Y",
  "poolAddress": "pool_address",
  "yAmount": 1000,
  "binRange": 10
}

# è·å–ç­–ç•¥åˆ—è¡¨
GET /api/strategies

# å¯åŠ¨ç­–ç•¥
POST /api/strategies/:id/start

# åœæ­¢ç­–ç•¥
POST /api/strategies/:id/stop

# è·å–ç­–ç•¥çŠ¶æ€
GET /api/strategies/:id/status
```

#### ç›‘æ§æ¥å£
```bash
# è·å–ç³»ç»Ÿå¥åº·çŠ¶æ€
GET /api/health

# è·å–æ€§èƒ½æŒ‡æ ‡
GET /api/metrics

# è·å–ç›‘æ§é¢æ¿æ•°æ®
GET /api/dashboard
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç­–ç•¥å¼•æ“é…ç½®
```typescript
// config/strategy-engine.json
{
  "maxConcurrentStrategies": 10,
  "strategyTimeoutMs": 300000,
  "performanceWindowMs": 3600000,
  "autoRecoveryEnabled": true,
  "monitoringInterval": 30000
}
```

### è°ƒåº¦å™¨é…ç½®
```typescript
// config/scheduler.json
{
  "queueSizeLimit": 1000,
  "maxConcurrentTasks": 5,
  "taskTimeoutMs": 60000,
  "retryConfig": {
    "maxRetries": 3,
    "retryDelay": 5000
  }
}
```

### ç›‘æ§é…ç½®
```typescript
// config/monitoring.json
{
  "metricsRetentionHours": 24,
  "alertThresholds": {
    "errorRate": 0.05,
    "responseTime": 5000,
    "memoryUsage": 0.8
  },
  "reportGeneration": {
    "enabled": true,
    "interval": 3600000
  }
}
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç³»ç»Ÿè°ƒä¼˜
1. **å†…å­˜ç®¡ç†** - è®¾ç½®åˆé€‚çš„å †å†…å­˜å¤§å°
2. **å¹¶å‘æ§åˆ¶** - æ ¹æ®ç³»ç»Ÿèµ„æºè°ƒæ•´å¹¶å‘æ•°
3. **ç¼“å­˜ç­–ç•¥** - å¯ç”¨Redisç¼“å­˜æå‡æ€§èƒ½
4. **æ•°æ®åº“ä¼˜åŒ–** - ä½¿ç”¨è¿æ¥æ± å’Œç´¢å¼•ä¼˜åŒ–

### ç­–ç•¥ä¼˜åŒ–
1. **æ‰¹é‡å¤„ç†** - ä½¿ç”¨æ‰¹é‡æ“ä½œå‡å°‘APIè°ƒç”¨
2. **æ™ºèƒ½è°ƒåº¦** - æ ¹æ®å¸‚åœºæ´»è·ƒåº¦è°ƒæ•´æ‰§è¡Œé¢‘ç‡
3. **èµ„æºç›‘æ§** - å®æ—¶ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ
4. **æ•…éšœéš”ç¦»** - ç­–ç•¥é—´çš„æ•…éšœéš”ç¦»æœºåˆ¶

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. ç¼–è¯‘é”™è¯¯**
```bash
# æ¸…ç†å¹¶é‡æ–°æ„å»º
npm run clean
npm run build
```

**2. è¿æ¥è¶…æ—¶**
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
npm run test:network

# éªŒè¯RPCèŠ‚ç‚¹çŠ¶æ€
npm run test:rpc
```

**3. ç­–ç•¥æ‰§è¡Œå¤±è´¥**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -f logs/strategy-engine.log

# æ£€æŸ¥é”™è¯¯æŠ¥å‘Š
npm run logs:errors
```

**4. å†…å­˜æ³„æ¼**
```bash
# ç›‘æ§å†…å­˜ä½¿ç”¨
npm run monitor:memory

# ç”Ÿæˆå †å†…å­˜å¿«ç…§
npm run debug:heap
```

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°ç­–ç•¥ç±»å‹
1. åœ¨ `src/types/strategy.ts` ä¸­æ·»åŠ æ–°çš„ç­–ç•¥ç±»å‹
2. åœ¨ `StrategyCore.ts` ä¸­å®ç°ç­–ç•¥é€»è¾‘
3. æ›´æ–°ç­–ç•¥éªŒè¯å’Œé…ç½®
4. æ·»åŠ ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹

### æ‰©å±•ç›‘æ§æŒ‡æ ‡
1. åœ¨ `StrategyMonitor.ts` ä¸­å®šä¹‰æ–°æŒ‡æ ‡
2. é…ç½®æ•°æ®æ”¶é›†é€»è¾‘
3. è®¾ç½®é¢„è­¦è§„åˆ™
4. æ›´æ–°ç›‘æ§é¢æ¿æ˜¾ç¤º

### é›†æˆæ–°çš„åŒºå—é“¾æœåŠ¡
1. åˆ›å»ºæ–°çš„æœåŠ¡æ¨¡å—
2. å®ç°æ ‡å‡†æ¥å£
3. æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨
4. é…ç½®æœåŠ¡é—´çš„ä¾èµ–å…³ç³»

## ğŸ“ æ”¯æŒä¸åé¦ˆ

- **é—®é¢˜åé¦ˆ**: è¯·æäº¤Issueåˆ°é¡¹ç›®ä»“åº“
- **æŠ€æœ¯æ”¯æŒ**: æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿ
- **åŠŸèƒ½å»ºè®®**: æ¬¢è¿æäº¤Feature Request

## ğŸ“„ æ›´æ–°æ—¥å¿—

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ… é‡æ„ç­–ç•¥å¼•æ“ï¼Œå®ç°æ¨¡å—åŒ–æ¶æ„
- âœ… æ–°å¢æ™ºèƒ½è°ƒåº¦å™¨å’Œæ•…éšœæ¢å¤æœºåˆ¶
- âœ… ä¼˜åŒ–ç›‘æ§ç³»ç»Ÿå’Œæ€§èƒ½æŒ‡æ ‡æ”¶é›†
- âœ… æ”¹è¿›çŠ¶æ€ç®¡ç†å’Œå¿«ç…§æ¢å¤åŠŸèƒ½
- âœ… å¢å¼ºAPIæ¥å£å’ŒWebæ§åˆ¶å°

### v1.0.0
- âœ… åŸºç¡€DLMMæµåŠ¨æ€§ç®¡ç†åŠŸèƒ½
- âœ… Solanaå’ŒMeteoraé›†æˆ
- âœ… ç®€å•ç­–ç•¥æ‰§è¡Œå¼•æ“

---

ğŸ‰ **æ­å–œï¼æ‚¨å·²ç»æŒæ¡äº†DLMMæµåŠ¨æ€§ç®¡ç†å™¨çš„å®Œæ•´ä½¿ç”¨æ–¹æ³•ã€‚å¼€å§‹æ‚¨çš„è‡ªåŠ¨åŒ–æµåŠ¨æ€§ç®¡ç†ä¹‹æ—…å§ï¼** 