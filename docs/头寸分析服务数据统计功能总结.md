# å¤´å¯¸åˆ†ææœåŠ¡æ•°æ®ç»Ÿè®¡åŠŸèƒ½æ€»ç»“

## ğŸ“‹ æœåŠ¡æ¦‚è¿°

**PositionAnalyticsService** æ˜¯ä¸€ä¸ªä¸‰å±‚æ¶æ„çš„å¤´å¯¸æ•°æ®ç»Ÿè®¡åˆ†ææœåŠ¡ï¼Œä¸ºæ™ºèƒ½æ­¢æŸæ¨¡å—æä¾›å…¨é¢çš„å¸‚åœºæ•°æ®å’Œåˆ†æç»“æœã€‚

### ğŸ—ï¸ æ¶æ„è®¾è®¡

```
ä¸šåŠ¡åè°ƒå±‚: PositionAnalyticsService
    â†“
åˆ†æè®¡ç®—å±‚: YieldAnalyzer + YieldOperator  
    â†“
æ•°æ®æœåŠ¡å±‚: UnifiedDataProvider
    â†“
åŒºå—é“¾æ•°æ®æº: Meteora API + Solana RPC
```

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

- **ç»Ÿä¸€æ•°æ®æµ**: å•æ¬¡APIè°ƒç”¨è·å–æ‰€æœ‰æ•°æ®ï¼Œå‡å°‘ç½‘ç»œå¼€é”€
- **è½®è¯¢å‘¨æœŸç¼“å­˜**: åŸºäºè½®è¯¢å‘¨æœŸçš„æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- **æ»‘åŠ¨çª—å£åˆ†æ**: å®æ—¶æ›´æ–°çš„å†å²æ•°æ®å¯¹æ¯”
- **åŒé‡æ”¶ç›Šç‡**: çœŸå®ç›ˆäº + æ‰‹ç»­è´¹æ•ˆç‡ä¸¤å¥—è®¡ç®—ä½“ç³»
- **è¿é”å¤´å¯¸æ”¯æŒ**: è‡ªåŠ¨è¯†åˆ«å•å¤´å¯¸vså¤šå¤´å¯¸ç­–ç•¥
- **ç´¯ç§¯æ”¶ç›Šè¿½è¸ª**: è§£å†³æ”¶ç›Šæå–å¹¶å‘å†²çªï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- **çœŸå®æ€»æ”¶ç›Šè®¡ç®—**: åŸºäºæœªæå–+å·²æå–æ”¶ç›Šçš„å®Œæ•´æ”¶ç›Šç‡åˆ†æ

---

## ğŸ“Š æ•°æ®è·å–èƒ½åŠ›

### 1. ä»·æ ¼æ•°æ®è·å–
```typescript
interface PriceData {
    currentPrice: number;           // å½“å‰æ± å­ä»·æ ¼
    priceHistory: PricePoint[];     // ä»·æ ¼å†å²è®°å½•ï¼ˆ120æ¡ï¼‰
    priceVolatility: number;        // ä»·æ ¼æ³¢åŠ¨ç‡
    priceDropPercentage: number;    // çŸ­æœŸä»·æ ¼å˜åŒ–
}
```

**æ•°æ®æ¥æº**: Meteora Pool API  
**æ›´æ–°é¢‘ç‡**: æ¯æ¬¡è½®è¯¢  
**å†å²æ·±åº¦**: 120æ¡è®°å½•ï¼ˆçº¦2å°æ—¶@1åˆ†é’Ÿé—´éš”ï¼‰  
**ç¼“å­˜ç­–ç•¥**: è½®è¯¢å‘¨æœŸå†…å¤ç”¨æ•°æ®

### 2. å¤´å¯¸æ•°æ®è·å–
```typescript
interface PositionData {
    positions: PositionInfo[];      // å¤´å¯¸è¯¦ç»†ä¿¡æ¯
    totalPositionValue: string;     // æ€»å¤´å¯¸ä»·å€¼ï¼ˆYä»£å¸ï¼‰
    positionAddresses: string[];    // å¤´å¯¸åœ°å€åˆ—è¡¨
}

interface PositionInfo {
    address: string;                // å¤´å¯¸åœ°å€
    poolAddress: string;           // æ± å­åœ°å€
    currentTokenX: string;         // å½“å‰Xä»£å¸æ•°é‡
    currentTokenY: string;         // å½“å‰Yä»£å¸æ•°é‡
    currentValueInY: string;       // å½“å‰ä»·å€¼ï¼ˆYä»£å¸è®¡ä»·ï¼‰
    feeX: string;                  // Xä»£å¸æ‰‹ç»­è´¹
    feeY: string;                  // Yä»£å¸æ‰‹ç»­è´¹
}
```

**æ•°æ®æ¥æº**: Meteora Position API  
**æ”¯æŒç±»å‹**: å•å¤´å¯¸ + è¿é”å¤´å¯¸  
**ç²¾åº¦å¤„ç†**: è‡ªåŠ¨å¤„ç†ä»£å¸ç²¾åº¦è½¬æ¢

### 3. æ”¶ç›Šæ•°æ®è·å–
```typescript
interface YieldData {
    totalExtractedYield: string;    // ç´¯è®¡å·²æå–æ”¶ç›Š
    currentPendingYield: string;    // å½“å‰å¾…æå–æ”¶ç›Š
    realTotalYield: string;         // çœŸå®æ€»æ”¶ç›Šï¼ˆæœªæå–+å·²æå–ï¼‰
    extractionCount: number;        // ç´¯ç§¯æå–æ¬¡æ•°
    yieldHistory: YieldRecord[];    // æ”¶ç›Šå†å²è®°å½•ï¼ˆ120æ¡ï¼‰
}
```

**è®¡ç®—æ–¹å¼**: å®æ—¶ç´¯åŠ æ‰€æœ‰å¤´å¯¸çš„æ‰‹ç»­è´¹æ”¶ç›Š  
**ç²¾åº¦å¤„ç†**: ä½¿ç”¨TokenPrecisionConverterç»Ÿä¸€å¤„ç†  
**ç´¯ç§¯è¿½è¸ª**: AccumulatedYieldManagerç®¡ç†å†å²æå–è®°å½•  
**æ•°æ®ä¸€è‡´æ€§**: æ”¶ç›Šæå–æ—¶è‡ªåŠ¨æ›´æ–°ç´¯ç§¯è®°å½•ï¼Œç¡®ä¿æ€»æ”¶ç›Šè®¡ç®—å‡†ç¡®

---

## ğŸ§® æ•°æ®è®¡ç®—èƒ½åŠ›

### 1. ä»·æ ¼è¶‹åŠ¿åˆ†æ
```typescript
interface PriceTrendAnalysis {
    last5Minutes: number;    // è¿‡å»5åˆ†é’Ÿä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”
    last15Minutes: number;   // è¿‡å»15åˆ†é’Ÿä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”
    lastHour: number;        // è¿‡å»1å°æ—¶ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”
}
```

**è®¡ç®—é€»è¾‘**: æ»‘åŠ¨çª—å£æœºåˆ¶ï¼Œæ¯æ¬¡è½®è¯¢é‡æ–°è®¡ç®—åŸºå‡†ç‚¹  
**å†å²æ•°æ®**: åŸºäºä»·æ ¼å¿«ç…§ï¼Œä¿ç•™1å°æ—¶å†…æ•°æ®  
**æ›´æ–°é¢‘ç‡**: æ¯æ¬¡è½®è¯¢å®æ—¶æ›´æ–°

### 2. åŒé‡æ”¶ç›Šç‡è®¡ç®—
```typescript
interface DualYieldRates {
    // 1. çœŸå®ç›ˆäºç™¾åˆ†æ¯”ï¼ˆæ€»ä½“æŠ•èµ„è¡¨ç°ï¼‰
    totalReturnRate: number;
    
    // 2. æ‰‹ç»­è´¹æ”¶ç›Šæ•ˆç‡ï¼ˆæ—¥åŒ–æ”¶ç›Šç‡ï¼‰
    feeYieldEfficiency: {
        last5Minutes: number;   // è¿‡å»5åˆ†é’Ÿæ—¥åŒ–æ”¶ç›Šç‡
        last15Minutes: number;  // è¿‡å»15åˆ†é’Ÿæ—¥åŒ–æ”¶ç›Šç‡
        lastHour: number;       // è¿‡å»1å°æ—¶æ—¥åŒ–æ”¶ç›Šç‡
    };
}
```

**çœŸå®ç›ˆäºè®¡ç®—**:
```
çœŸå®ç›ˆäº% = (å½“å‰å¤´å¯¸ä»·å€¼ + å·²æå–æ”¶ç›Š - åˆå§‹æŠ•èµ„) / åˆå§‹æŠ•èµ„ Ã— 100%
```

**æ‰‹ç»­è´¹æ•ˆç‡è®¡ç®—**:
```
çœŸå®æ€»æ”¶ç›Š = å½“å‰å¾…æå–æ”¶ç›Š + å†å²ç´¯ç§¯æå–æ”¶ç›Š
æ—¶é—´æ®µæ”¶ç›Šå¢é•¿ = å½“å‰çœŸå®æ€»æ”¶ç›Š - Nåˆ†é’Ÿå‰çœŸå®æ€»æ”¶ç›Š
æ—¥åŒ–æ”¶ç›Šç‡ = (æ—¶é—´æ®µæ”¶ç›Šå¢é•¿ / åˆå§‹æŠ•èµ„) Ã— æ—¶é—´å€æ•° Ã— 100%
æ—¶é—´å€æ•°: 5åˆ†é’ŸÃ—288, 15åˆ†é’ŸÃ—96, 1å°æ—¶Ã—24
```

**å…³é”®ç‰¹æ€§**:
- åŸºäºçœŸå®æ€»æ”¶ç›Šå¿«ç…§è®¡ç®—ï¼Œé¿å…æå–æ—¶æ•°æ®è·³è·ƒ
- æ»‘åŠ¨çª—å£æœºåˆ¶ï¼Œæ¯æ¬¡è½®è¯¢é‡æ–°è®¡ç®—åŸºå‡†ç‚¹
- å†…å­˜å¿«ç…§ä¿ç•™1å°æ—¶å†å²ï¼Œæ”¯æŒå¤šæ—¶é—´ç»´åº¦åˆ†æ

### 3. å¤´å¯¸æŸå¤±åˆ†æ
```typescript
interface PositionLoss {
    positionAddress: string;     // å¤´å¯¸åœ°å€
    currentValueInY: string;     // å½“å‰ä»·å€¼
    initialInvestment: string;   // åˆå§‹æŠ•èµ„
    lossAmount: string;          // æŸå¤±é‡‘é¢
    lossPercentage: number;      // æŸå¤±ç™¾åˆ†æ¯”
    timestamp: number;           // è®¡ç®—æ—¶é—´æˆ³
    priceAtCalculation: number;  // è®¡ç®—æ—¶ä»·æ ¼
}
```

**å•å¤´å¯¸æ¨¡å¼**: ç›´æ¥è®¡ç®—å½“å‰ä»·å€¼vsåˆå§‹æŠ•èµ„  
**è¿é”å¤´å¯¸æ¨¡å¼**: è®¡ç®—æ€»ä½“ä»·å€¼vsæ€»æŠ•èµ„ï¼Œè¿”å›æ•´ä½“ç›ˆäº

### 4. çœŸå®ç›ˆäºæŠ¥å‘Š
```typescript
interface RealPnL {
    totalExtractedYield: string;  // ç´¯è®¡æå–æ”¶ç›Š
    currentPositionValue: string; // å½“å‰å¤´å¯¸ä»·å€¼
    initialInvestment: string;    // åˆå§‹æŠ•èµ„
    realPnLAmount: string;        // çœŸå®ç›ˆäºé‡‘é¢
    realPnLPercentage: number;    // çœŸå®ç›ˆäºç™¾åˆ†æ¯”
    breakdown: {
        extractedYieldValue: number;    // å·²æå–æ”¶ç›Šä»·å€¼
        positionValueChange: number;    // å¤´å¯¸ä»·å€¼å˜åŒ–
        totalReturn: number;            // æ€»å›æŠ¥
    };
}
```

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡èƒ½åŠ›

### 1. æ”¶ç›Šç»Ÿè®¡
```typescript
interface YieldStatistics {
    currentPendingYield: string;     // å½“å‰å¾…æå–æ”¶ç›Š
    totalExtractedYield: string;     // ç´¯è®¡å·²æå–æ”¶ç›Š
    realTotalYield: string;          // çœŸå®æ€»æ”¶ç›Šï¼ˆæ ¸å¿ƒæŒ‡æ ‡ï¼‰
    extractionCount: number;         // ç´¯ç§¯æå–æ¬¡æ•°
    yieldGrowthRate: number;         // æ”¶ç›Šå¢é•¿ç‡
    yieldTrend: 'increasing' | 'decreasing' | 'stable';
    projectedDailyYield: string;     // é¢„è®¡æ—¥æ”¶ç›Š
    projectedMonthlyYield: string;   // é¢„è®¡æœˆæ”¶ç›Š
    lastYieldUpdate: number;         // æœ€åæ›´æ–°æ—¶é—´
    
    // åŒé‡æ”¶ç›Šç‡ï¼ˆåŸºäºçœŸå®æ€»æ”¶ç›Šè®¡ç®—ï¼‰
    dualYieldRates: DualYieldRates;
}
```

**ç´¯ç§¯æ”¶ç›Šè¿½è¸ªæœºåˆ¶**:
- **æ•°æ®æŒä¹…åŒ–**: æå–è®°å½•ä¿å­˜åˆ°`data/yield-trackers.json`
- **è‡ªåŠ¨è®°å½•**: æ¯æ¬¡æ”¶ç›Šæå–è‡ªåŠ¨è®°å½•åˆ°ç´¯ç§¯ç®¡ç†å™¨
- **é‡å¯æ¢å¤**: ç³»ç»Ÿé‡å¯åè‡ªåŠ¨åŠ è½½å†å²æå–è®°å½•
- **å¹¶å‘å®‰å…¨**: è§£å†³æ”¶ç›Šæå–ä¸æ”¶ç›Šç‡è®¡ç®—çš„å¹¶å‘å†²çª

### 2. ä»·æ ¼ç»Ÿè®¡
```typescript
interface PriceStatistics {
    currentPrice: number;            // å½“å‰ä»·æ ¼
    priceHistory: PricePoint[];      // ä»·æ ¼å†å²ï¼ˆ120æ¡ï¼‰
    priceVolatility: number;         // ä»·æ ¼æ³¢åŠ¨ç‡
    priceTrendAnalysis: {
        last5Minutes: number;        // 5åˆ†é’Ÿä»·æ ¼å˜åŒ–
        last15Minutes: number;       // 15åˆ†é’Ÿä»·æ ¼å˜åŒ–
        lastHour: number;            // 1å°æ—¶ä»·æ ¼å˜åŒ–
    };
}
```

### 3. æ€§èƒ½ç»Ÿè®¡
```typescript
interface PerformanceMetrics {
    totalApiCalls: number;           // æ€»APIè°ƒç”¨æ¬¡æ•°
    avgResponseTime: number;         // å¹³å‡å“åº”æ—¶é—´
    errorRate: number;               // é”™è¯¯ç‡
    cacheHitRate: number;            // ç¼“å­˜å‘½ä¸­ç‡
    lastUpdate: number;              // æœ€åæ›´æ–°æ—¶é—´
}
```

---

## ğŸ”„ æ•°æ®æ›´æ–°æœºåˆ¶

### 1. è½®è¯¢å‘¨æœŸç®¡ç†
```typescript
// å¼€å§‹æ–°çš„è½®è¯¢å‘¨æœŸ
startNewPollingCycle(intervalMs?: number): void

// è·å–å½“å‰è½®è¯¢ä¿¡æ¯
getCurrentPollingInfo(): { 
    cycle: number; 
    interval: number; 
    hasCachedData: boolean; 
}
```

### 2. ç¼“å­˜ç­–ç•¥
- **è½®è¯¢å‘¨æœŸç¼“å­˜**: åŒä¸€è½®è¯¢å‘¨æœŸå†…å¤ç”¨æ•°æ®
- **è‡ªåŠ¨å¤±æ•ˆ**: æ–°è½®è¯¢å‘¨æœŸå¼€å§‹æ—¶è‡ªåŠ¨æ¸…é™¤ç¼“å­˜
- **æ‰‹åŠ¨æ¸…é™¤**: æ”¯æŒæ‰‹åŠ¨æ¸…é™¤ç¼“å­˜

### 3. å†å²æ•°æ®ç®¡ç†
- **ä»·æ ¼å†å²**: ä¿ç•™120æ¡è®°å½•ï¼Œè‡ªåŠ¨æ¸…ç†æ—§æ•°æ®
- **æ”¶ç›Šå†å²**: ä¿ç•™120æ¡è®°å½•ï¼Œä¸ä»·æ ¼å†å²åŒæ­¥
- **å¿«ç…§æ•°æ®**: ä¿ç•™1å°æ—¶å†…çš„ä»·æ ¼å’Œæ”¶ç›Šå¿«ç…§
- **ç´¯ç§¯æ”¶ç›Šè®°å½•**: æŒä¹…åŒ–å­˜å‚¨æ‰€æœ‰å†å²æå–è®°å½•
- **çœŸå®æ€»æ”¶ç›Šå¿«ç…§**: æ¯æ¬¡è½®è¯¢å­˜å‚¨çœŸå®æ€»æ”¶ç›Šå¿«ç…§ï¼Œç¡®ä¿æ”¶ç›Šç‡è®¡ç®—å‡†ç¡®æ€§

---

## ğŸ¯ æ™ºèƒ½æ­¢æŸæ¨¡å—æ¥å…¥æ¥å£

### 1. æ ¸å¿ƒæ•°æ®æ¥å£
```typescript
// è·å–æ™ºèƒ½æ­¢æŸæ‰€éœ€çš„å®Œæ•´æ•°æ®
async getSmartStopLossData(): Promise<MarketData>

// è·å–å®Œæ•´åˆ†ææŠ¥å‘Š
async getCompleteAnalyticsReport(): Promise<AnalyticsReport>
```

### 2. å•é¡¹æ•°æ®æ¥å£
```typescript
// ä»·æ ¼ç›¸å…³
async getCurrentPrice(): Promise<number>
async getPriceTrendAnalysis(): Promise<PriceTrendAnalysis[]>

// æ”¶ç›Šç›¸å…³
async getYieldStatistics(): Promise<YieldStatistics>
async getPendingYield(): Promise<string>
async isExtractionReady(): Promise<boolean>

// å¤´å¯¸ç›¸å…³
async getPositionLossAnalysis(): Promise<PositionLoss[]>
async getRealPnLReport(): Promise<RealPnL>
```

### 3. ç›‘æ§ç®¡ç†æ¥å£
```typescript
// è®¾ç½®å¤´å¯¸ç›‘æ§
async setupPositionMonitoring(params: PositionSetupParams): Promise<void>

// åœæ­¢ç›‘æ§
async stopMonitoring(): Promise<void>

// å¥åº·æ£€æŸ¥
async healthCheck(): Promise<HealthStatus>
```

---

## ğŸ› ï¸ ä½¿ç”¨ç¤ºä¾‹

### æ™ºèƒ½æ­¢æŸæ¨¡å—æ¥å…¥ç¤ºä¾‹
```typescript
// 1. åˆå§‹åŒ–æœåŠ¡
const analyticsService = container.resolve<IPositionAnalyticsService>(TYPES.PositionAnalyticsService);

// 2. è®¾ç½®ç›‘æ§å‚æ•°
await analyticsService.setupPositionMonitoring({
    poolAddress: 'FTUUwFN25knhihreUS9hjmBS2zZMJHdTZVAiCKedhjw9',
    positionAddresses: ['BWxnHVbS7K2KAb1TBkytSwvPBCAG6eThXkDmZg3GvS35'],
    initialInvestmentAmount: '0.025',
    config: {
        priceMonitorInterval: 30000,
        yieldExtractionThreshold: '10'
    }
});

// 3. è·å–æ™ºèƒ½æ­¢æŸæ•°æ®
const marketData = await analyticsService.getSmartStopLossData();

// 4. è·å–å®Œæ•´åˆ†ææŠ¥å‘Š
const report = await analyticsService.getCompleteAnalyticsReport();
```

---

## ğŸ“‹ æŠ€æœ¯ç‰¹æ€§æ€»ç»“

### âœ… å·²å®ç°åŠŸèƒ½
- [x] ç»Ÿä¸€æ•°æ®è·å–å’Œç¼“å­˜æœºåˆ¶
- [x] è½®è¯¢å‘¨æœŸç®¡ç†
- [x] åŒé‡æ”¶ç›Šç‡è®¡ç®—ä½“ç³»ï¼ˆåŸºäºçœŸå®æ€»æ”¶ç›Šï¼‰
- [x] æ»‘åŠ¨çª—å£ä»·æ ¼è¶‹åŠ¿åˆ†æ
- [x] è¿é”å¤´å¯¸è‡ªåŠ¨è¯†åˆ«
- [x] å†å²æ•°æ®ç®¡ç†ï¼ˆ120æ¡è®°å½•ï¼‰
- [x] æ€§èƒ½ç›‘æ§å’Œå¥åº·æ£€æŸ¥
- [x] æ™ºèƒ½æ­¢æŸæ¨¡å—æ•°æ®æ¥å£
- [x] ç´¯ç§¯æ”¶ç›Šè¿½è¸ªç³»ç»Ÿï¼ˆAccumulatedYieldManagerï¼‰
- [x] æ”¶ç›Šæå–å¹¶å‘å†²çªè§£å†³æ–¹æ¡ˆ
- [x] çœŸå®æ€»æ”¶ç›ŠæŒä¹…åŒ–å­˜å‚¨

### ğŸ”§ é…ç½®å‚æ•°
- **å†å²è®°å½•æ•°é‡**: 120æ¡ï¼ˆç»Ÿä¸€ä»·æ ¼å’Œæ”¶ç›Šå†å²ï¼‰
- **å¿«ç…§ä¿ç•™æ—¶é—´**: 1å°æ—¶
- **è½®è¯¢é—´éš”**: å¯é…ç½®ï¼ˆé»˜è®¤30ç§’ï¼‰
- **æ”¶ç›Šæå–é˜ˆå€¼**: å¯é…ç½®ï¼ˆé»˜è®¤10ä»£å¸ï¼‰

### ğŸš€ æ€§èƒ½ä¼˜åŒ–
- **APIè°ƒç”¨ä¼˜åŒ–**: å•æ¬¡è°ƒç”¨è·å–æ‰€æœ‰æ•°æ®
- **ç¼“å­˜æœºåˆ¶**: è½®è¯¢å‘¨æœŸå†…æ•°æ®å¤ç”¨
- **å¹¶è¡Œè®¡ç®—**: åˆ†æä»»åŠ¡å¹¶å‘æ‰§è¡Œ
- **å†…å­˜ç®¡ç†**: è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

æœ¬æœåŠ¡ä¸ºæ™ºèƒ½æ­¢æŸæ¨¡å—æä¾›å®Œæ•´çš„æ•°æ®ç»Ÿè®¡åˆ†æèƒ½åŠ›ï¼Œæ”¯æŒå®æ—¶ç›‘æ§ã€å†å²åˆ†æå’Œè¶‹åŠ¿é¢„æµ‹ã€‚å¦‚éœ€æ¥å…¥æˆ–å®šåˆ¶åŠŸèƒ½ï¼Œè¯·å‚è€ƒä¸Šè¿°æ¥å£æ–‡æ¡£ã€‚

**æœåŠ¡ç‰ˆæœ¬**: v3.0.0  
**æ¶æ„æ¨¡å¼**: ä¸‰å±‚åˆ†ç¦»æ¶æ„  
**æ•°æ®æ¥æº**: Meteora DLMM API + Solana RPC  
**æ›´æ–°æ—¥æœŸ**: 2024å¹´1æœˆ  
**æœ€è¿‘æ›´æ–°**: æ–°å¢ç´¯ç§¯æ”¶ç›Šè¿½è¸ªç³»ç»Ÿï¼Œè§£å†³æ”¶ç›Šæå–å¹¶å‘å†²çªé—®é¢˜

---

## ğŸ”¥ é‡è¦æ›´æ–°ï¼šç´¯ç§¯æ”¶ç›Šè¿½è¸ªç³»ç»Ÿ

### é—®é¢˜èƒŒæ™¯
åœ¨åŸæœ‰ç³»ç»Ÿä¸­ï¼Œå½“æ”¶ç›Šæå–åŠŸèƒ½è¿è¡Œæ—¶ï¼Œä¼šå¯¼è‡´ä¸‹æ¬¡è½®è¯¢çš„æ”¶ç›Šç‡è®¡ç®—å‡ºç°é”™è¯¯ï¼š
```
T1: è½®è¯¢è·å– â†’ æ”¶ç›Š = 0.005Y
T2: è®¡ç®—æ”¶ç›Šç‡ â†’ åŸºäº 0.005Y è®¡ç®—  
T3: æ”¶ç›Šæå– â†’ æ”¶ç›Šå˜ä¸º 0Y âš¡ å†²çªç‚¹
T4: ä¸‹æ¬¡è½®è¯¢ â†’ æ”¶ç›Š = 0Yï¼Œå†å²æ•°æ®åŸºäº 0.005Y
T5: æ”¶ç›Šç‡å¼‚å¸¸ â†’ è´Ÿæ”¶ç›Šç‡æˆ–æ•°æ®è·³è·ƒ
```

### è§£å†³æ–¹æ¡ˆ
å®ç°**ç´¯ç§¯æ”¶ç›Šè¿½è¸ªç³»ç»Ÿ**ï¼Œç¡®ä¿æ”¶ç›Šç‡è®¡ç®—åŸºäº**çœŸå®æ€»æ”¶ç›Š**ï¼š

#### æ ¸å¿ƒå…¬å¼
```typescript
çœŸå®æ€»æ”¶ç›Š = å½“å‰å¾…æå–æ”¶ç›Š + å†å²ç´¯ç§¯æå–æ”¶ç›Š
æ”¶ç›Šç‡ = (å½“å‰çœŸå®æ€»æ”¶ç›Š - Nåˆ†é’Ÿå‰çœŸå®æ€»æ”¶ç›Š) / åˆå§‹æŠ•èµ„ Ã— 100%
```

#### ç³»ç»Ÿæ¶æ„
```
YieldOperator (æ”¶ç›Šæå–)
    â†“ æå–æˆåŠŸåè‡ªåŠ¨è®°å½•
AccumulatedYieldManager (ç´¯ç§¯ç®¡ç†)
    â†“ æä¾›çœŸå®æ€»æ”¶ç›Š
UnifiedDataProvider (æ•°æ®æä¾›)
    â†“ åŸºäºçœŸå®æ€»æ”¶ç›Šè®¡ç®—
YieldAnalyzer (æ”¶ç›Šåˆ†æ)
```

#### æ•°æ®ç»“æ„
```typescript
interface AccumulatedYieldTracker {
    poolAddress: string;
    positionAddresses: string[];
    totalExtractedYield: string;  // ç´¯ç§¯æå–çš„Yä»£å¸ä»·å€¼
    extractionHistory: YieldExtractionRecord[];
}

interface YieldExtractionRecord {
    timestamp: number;
    extractedXAmount: string;     // åŸå§‹Xä»£å¸æ•°é‡
    extractedYAmount: string;     // åŸå§‹Yä»£å¸æ•°é‡  
    calculatedYValue: string;     // è®¡ç®—åçš„Yä»£å¸ç­‰ä»·å€¼
    transactionSignature: string;
}
```

### æŠ€æœ¯ç‰¹ç‚¹
- âœ… **æ•°æ®ä¸€è‡´æ€§**: æ— è®ºä½•æ—¶æå–ï¼Œæ”¶ç›Šç‡è®¡ç®—å§‹ç»ˆå‡†ç¡®
- âœ… **å¹¶å‘å®‰å…¨**: è§£å†³æå–ä¸è®¡ç®—çš„æ—¶åºå†²çª
- âœ… **æŒä¹…åŒ–å­˜å‚¨**: æ•°æ®ä¿å­˜åˆ°`data/yield-trackers.json`
- âœ… **è‡ªåŠ¨é›†æˆ**: ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼é›†æˆï¼Œæœ€å°åŒ–ä»£ç ä¿®æ”¹
- âœ… **é‡å¯æ¢å¤**: ç³»ç»Ÿé‡å¯åè‡ªåŠ¨åŠ è½½å†å²æ•°æ® 